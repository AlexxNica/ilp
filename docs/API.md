# ILP Client Documentation

## Client API

### Client.canConnectToLedger(auth)

`Client.canConnectToLedger( auth : Object ) â‡’ Boolean`

Checks whether the Client library has a ledger plugin that supports the given ledger type.

### client = new Client(opts)

`opts`:

```js
{
  auth: {
    // defined by the ledger plugin
  },
  conditionSecretSeed: new Buffer('some secret'), // defaults to using crypto.randomBytes(32)
  maxHoldDuration: 10000, // defaults to 10000 ms (10 seconds)
  autoConnect: true // defaults to true
}
```

**TODO**: should the client accept and pass on the `store` parameter?

Automatically connects to the ledger plugin, unless the `autoConnect: false` parameter is passed in

### client.ledger

Instance of [`LedgerPlugin`](https://github.com/interledger/rfcs/blob/master/0004-ledger-plugin-interface/). This can be used for interacting with the ledger directly once the client has connected. The following helper functions use these methods to simplify common usage patterns.

### client.createRequest(params)

`params`:

```js
{
  destinationAmount: '10',
  expiresAt: '2016-05-31T12:00:00',
  // condition: 'cc:0:...',
  // unsafeOptimisticTransport: false // see OTP spec: https://github.com/interledger/rfcs/blob/master/0005-optimistic-transport-protocol/0005-optimistic-transport-protocol.md 
}
```

Helper function for creating payment requests. This generates an [ILP packet](https://github.com/interledger/rfcs/blob/master/0003-interledger-protocol/0003-interledger-protocol.md) using the client user's account as the destination address.

**TODO**: should this return an ILP packet or an object that emits events and has helper functions for figuring out when 

### client.payRequest(params)

`params`:

```js
{
  request: new Buffer('ilp packet from receiver'),
  maxSourceAmount: '10',
  maxHoldDuration: 10000, // defaults to client option
}
```

Returns `Promise<OutgoingTransfer>` (see [`OutgoingTransfer`](https://github.com/interledger/rfcs/blob/master/0004-ledger-plugin-interface/0004-ledger-plugin-interface.md#outgoingtransfer))

### client.matches(transfer, expectedPacket)

This function throws an error if the given `transfer` does not match the `expectedPacket` (for example if the amount is too low)

**TODO**: should the ledger plugin automatically tell you or error in some way if an incoming transfer doesn't match the packet it contains (e.g. if the packet says the destinationAmount should be 10 USD and the transfer only has $9.50)?

### client.sendPayment(params)

```js
{
  destinationAddress: 'ilp:big-ledger/other-ledger/destination-ledger#receiver',
  destinationAmount: '11',
  maxSourceAmount: '10',
  // sourceAmount can be specified instead of destinationAmount and maxSourceAmount
  destinationExpiryDuration: '2016-05-31T12:00:00.000Z',
  executionCondition: 'cc:0:...', // 
  cancellationCondition: 'cc:0:...', 
  // unsafeOptimisticTransport: false will prevent the client from throwing an error if no executionCondition is given
  data: new Buffer('some extra data to send to the recipient')
}
```

Helper function for sending payments, which handles quoting, ILP packet creation, and local transfer sending.

Note that the condition must be supplied by the user for Universal or Atomic payments.

**TODO**: what other parameters do we need for Atomic payments?

### client.autoAcceptPayment(expectedPacket)

This method is used to have the client automatically validate and fulfill the condition of incoming transfers.

Note that this function only works if the `executionCondition` is generated by the client.

**TODO**: should this take in a complete packet or just some parameters?
